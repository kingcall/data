# 神策 数据接入

- ## 神策狗屎一般的语法 
    - 新建表   
         CREATE TABLE rawdata.export_data AS /*SA_BEGIN(production)*/ SELECT user_id,time,event, $os AS _os FROM events WHERE `date`=CURRENT_DATE() LIMIT 10 /*SA_END*/
    - 覆盖表  
        INSERT OVERWRITE TABLE rawdata.export_data /*SA_BEGIN(production)*/ SELECT user_id,time,event, $os AS _os FROM events WHERE `date`=CURRENT_DATE() LIMIT 100 /*SA_END*/
    - 添加数据
        INSERT into TABLE rawdata.export_data /*SA_BEGIN(production)*/ SELECT user_id,time,event, $os AS _os FROM events WHERE `date`=CURRENT_DATE() LIMIT 200 /*SA_END*/;
-  ## 数据入库后的导出与迁移
      - 导出(发现 hive 支持的并不好)
         create table test.test1 as select * from src_workorder_type limit 10;  
         insert overwrite table test.test1  select * from src_workorder_type limit 100;    
         INSERT OVERWRITE [LOCAL] DIRECTORY directory1 SELECT ... FROM ... 可以写到本地或者集群   
         impala-shell -q  "select * from rawdata.export_data" -B --output_delimiter="\t" -o /home/liuwenqiang/put.txt 借助impala将数据导出
      - 迁移
           - 脚本方式
           - distcp 方式
               hadoop distcp hdfs://data01:8020/user/hive/warehouse/rawdata.db/export_data/   hdfs://172.16.3.249:8020/bar/foo     
                    
                    
         
         event                            | string    |         |
         | user_id                          | double    |         |
         | distinct_id                      | string    |         |
         | date                             | bigint    |         |
         | time                             | timestamp |         |
         | $latest_utm_medium               | string    |         |
         | ccc                              | string    |         |
         | t_channel_var                    | double    |         |
         | text_content                     | string    |         |
         | shareType                        | string    |         |
         | scene                            | double    |         |
         | mfm_userid_share                 | string    |         |
         | user_isLogin                     | string    |         |
         | select_content                   | string    |         |
         | brand                            | string    |         |
         | $element_id                      | string    |         |
         | user_life_cycle                  | string    |         |
         | course_isSoundRecording          | string    |         |
         | bbb                              | string    |         |
         | course_isWrittenTeacherComment   | string    |         |
         | register_date_time               | bigint    |         |
         | $model                           | string    |         |
         | user_isFirstcomplete             | string    |         |
         | $browser                         | string    |         |
         | course_date_time                 | bigint    |         |
         | network_condition                | string    |         |
         | $country                         | string    |         |
         | $utm_campaign                    | string    |         |
         | site_id                          | string    |         |
         | shareType_test                   | string    |         |
         | aaa                              | string    |         |
         | video_name                       | string    |         |
         | course_reserveType               | string    |         |
         | page_type                        | string    |         |
         | user_name                        | string    |         |
         | teacher_id                       | string    |         |
         | mpl_userid_share                 | string    |         |
         | $ip                              | string    |         |
         | $screen_height                   | double    |         |
         | verificationcode_state           | string    |         |
         | User_signUpChannel               | string    |         |
         | shareContent                     | string    |         |
         | course_instrument_Type           | string    |         |
         | course_classType                 | string    |         |
         | t_OS_type                        | string    |         |
         | medalID                          | string    |         |
         | course_proficiencyScore          | string    |         |
         | t_course_number                  | double    |         |
         | IsAddedToFav                     | string    |         |
         | $referrer_host                   | string    |         |
         | course_praiseAmount              | double    |         |
         | course_edit_date_time            | bigint    |         |
         | video4_Duration_minutes          | double    |         |
         | button_name                      | string    |         |
         | teacher_isOpentime               | string    |         |
         | t_device_version                 | string    |         |
         | course_isWrittenComment          | string    |         |
         | register_type                    | string    |         |
         | course_labelList_positive        | string    |         |
         | text_name                        | string    |         |
         | course_labelList_nagative        | string    |         |
         | fail_type                        | string    |         |
         | device_is_passed                 | string    |         |
         | courseID                         | string    |         |
         | course_rhythmScore               | string    |         |
         | $track_signup_original_id        | string    |         |
         | page_url                         | string    |         |
         | $utm_medium                      | string    |         |
         | $element_type                    | string    |         |
         | app_version                      | string    |         |
         | device_firm                      | string    |         |
         | first_visit_source               | string    |         |
         | $is_first_time                   | string    |         |
         | ProductId                        | string    |         |
         | User_loginChannel                | string    |         |
         | entrance_Type                    | string    |         |
         | mfm_id                           | double    |         |
         | entranceArea                     | string    |         |
         | List                             | double    |         |
         | t_course_instrument_type         | string    |         |
         | $latest_scene                    | string    |         |
         | area                             | string    |         |
         | tabName                          | string    |         |
         | mfm_enter_time                   | bigint    |         |
         | utm_campaign                     | string    |         |
         | $screen_width                    | double    |         |
         | OS_type                          | string    |         |
         | list_                            | double    |         |
         | music_uploadChannel              | string    |         |
         | $title                           | string    |         |
         | name                             | string    |         |
         | $latest_traffic_source_type      | string    |         |
         | wifiTest_isPass                  | string    |         |
         | mpl_title                        | string    |         |
         | utm_source                       | string    |         |
         | desc                             | string    |         |
         | wifitest_is_passed               | string    |         |
         | promopt                          | string    |         |
         | musiccourseID                    | string    |         |
         | ProductPrice                     | double    |         |
         | t_user_isLogin                   | string    |         |
         | t_teacher_grade                  | string    |         |
         | $referrer                        | string    |         |
         | fisheyeTest_is_passed            | string    |         |
         | $url_path                        | string    |         |
         | fisheyeTest_isPass               | string    |         |
         | $element_position                | string    |         |
         | video3_Duration_minutes          | double    |         |
         | $url                             | string    |         |
         | $latest_utm_term                 | string    |         |
         | t_teacher_name                   | string    |         |
         | $kafka_offset                    | double    |         |
         | url_path                         | string    |         |
         | utm_content                      | string    |         |
         | $carrier                         | string    |         |
         | $os_version                      | string    |         |
         | $is_first_day                    | string    |         |
         | course_payType                   | string    |         |
         | message                          | string    |         |
         | t_imei                           | string    |         |
         | t_score_id                       | string    |         |
         | course_expressivenessScore       | string    |         |
         | imei                             | string    |         |
         | user_kid_name                    | string    |         |
         | poster_id                        | double    |         |
         | install_date_time                | bigint    |         |
         | $manufacturer                    | string    |         |
         | device_version                   | string    |         |
         | _Distinct_id                     | string    |         |
         | t_score_name                     | string    |         |
         | OrderPaid                        | double    |         |
         | button_type                      | string    |         |
         | $os                              | string    |         |
         | video_position                   | string    |         |
         | $wifi                            | string    |         |
         | t_song_name                      | string    |         |
         | cource_edit_type                 | string    |         |
         | domain_name                      | string    |         |
         | first_visit_os                   | string    |         |
         | device_imei                      | string    |         |
         | content_detail                   | string    |         |
         | $scene                           | string    |         |
         | idfv                             | string    |         |
         | course_is_Red                    | string    |         |
         | to_page_url                      | string    |         |
         | click_coordinate_x               | double    |         |
         | $bot_name                        | string    |         |
         | install_DateTime                 | bigint    |         |
         | t_music_attribute                | string    |         |
         | OS_version                       | string    |         |
         | register_source                  | string    |         |
         | ProductCatalog                   | string    |         |
         | idfa                             | string    |         |
         | course_complete_date_time        | bigint    |         |
         | $app_version                     | string    |         |
         | t_t_teacher_name                 | string    |         |
         | t_install_date_time              | bigint    |         |
         | finish_type                      | string    |         |
         | $resume_from_background          | string    |         |
         | $is_login_id                     | string    |         |
         | $browser_version                 | string    |         |
         | click_coordinate_Y               | double    |         |
         | $viewport_position               | double    |         |
         | user_is_paid                     | string    |         |
         | t_idfv                           | string    |         |
         | isLogin                          | string    |         |
         | mfm_exit_time                    | bigint    |         |
         | t_idfa                           | string    |         |
         | mpl_enter_time                   | bigint    |         |
         | aaaaaaaaa                        | string    |         |
         | $viewport_width                  | double    |         |
         | $utm_source                      | string    |         |
         | url                              | string    |         |
         | user_id_mk                       | string    |         |
         | device_mac                       | string    |         |
         | $utm_content                     | string    |         |
         | video1_Duration_minutes          | string    |         |
         | t_teacher_id                     | string    |         |
         | page_path                        | string    |         |
         | button_position                  | string    |         |
         | scoreID                          | string    |         |
         | user_life_Cycle_                 | string    |         |
         | ProductName                      | string    |         |
         | login_type                       | string    |         |
         | utm_medium                       | string    |         |
         | $network_type                    | string    |         |
         | music_Attribute                  | string    |         |
         | t_OS_version                     | string    |         |
         | user_isFirstreserve              | string    |         |
         | $latest_search_keyword           | string    |         |
         | $province                        | string    |         |
         | eventName                        | string    |         |
         | $element_content                 | string    |         |
         | to_page_title                    | string    |         |
         | install_time                     | double    |         |
         | entrance_area                    | string    |         |
         | course_number                    | double    |         |
         | coordinate_x                     | string    |         |
         | $city                            | string    |         |
         | coordinate_y                     | string    |         |
         | Channel                          | string    |         |
         | event_duration                   | double    |         |
         | mpl_id                           | string    |         |
         | course_teacherRating             | string    |         |
         | mfm_source                       | string    |         |
         | course_Duration_minutes          | double    |         |
         | channel_var                      | double    |         |
         | control_detail                   | string    |         |
         | t_platform                       | string    |         |
         | video_Duration_minutes_4         | double    |         |
         | video_Duration_minutes_3         | double    |         |
         | userType                         | string    |         |
         | position                         | string    |         |
         | $screen_name                     | string    |         |
         | video_Duration_minutes_2         | double    |         |
         | phone_Number                     | string    |         |
         | video_Duration_minutes_1         | double    |         |
         | video2_Duration_minutes          | double    |         |
         | ProductIdList                    | string    |         |
         | user_source                      | string    |         |
         | Dot_UploadMusic                  | string    |         |
         | $utm_term                        | string    |         |
         | platform                         | string    |         |
         | $viewport_height                 | double    |         |
         | course_isScreenshot              | string    |         |
         | $device_id                       | string    |         |
         | User_kidName                     | string    |         |
         | $latest_utm_campaign             | string    |         |
         | course_Requirement_uploadChannel | string    |         |
         | $url_query                       | string    |         |
         | $latest_referrer                 | string    |         |
         | t_userType                       | string    |         |
         | mfm_title                        | string    |         |
         | medal_name                       | string    |         |
         | t_android_id                     | string    |         |
         | functionName                     | string    |         |
         | t_app_version                    | string    |         |
         | viewChannel                      | string    |         |
         | $latest_utm_source               | string    |         |
         | course_isSoundComment            | string    |         |
         | banner_index                     | double    |         |
         | promopt_type                     | string    |         |
         | share_path                       | string    |         |
         | utm_term                         | string    |         |
         | testList                         | string    |         |
         | course_Score                     | double    |         |
         | t_course_id                      | string    |         |
         | course_intonationScore           | string    |         |
         | $latest_referrer_host            | string    |         |
         | android_id                       | string    |         |
         | $latest_utm_content              | string    |           
